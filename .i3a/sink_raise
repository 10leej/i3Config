#!/bin/bash

#----------------------------------------------------------------------------------
# Project Name      - $HOME/.i3a/master_raise
# Started On        - Sun 24 Sep 00:30:17 BST 2017
# Last Change       - Thu  4 Apr 16:19:47 BST 2019
# Author E-Mail     - terminalforlife@yahoo.com
# Author GitHub     - https://github.com/terminalforlife
#----------------------------------------------------------------------------------
# If this breaks on Ubuntu 16.04, install from an earlier commit.
#----------------------------------------------------------------------------------

MASTER="alsa_output.usb-Burr-Brown_from_TI_USB_Audio_CODEC-00.analog-stereo"
if [ -x /usr/bin/pacmd ]; then
	declare -i N=0
	while read -a X; do
		if [[ "${X[0]}" =~ volume: ]]; then
			N+=1

			if [ $N -eq 2 ]; then
				printf -v VOL "%d" "${X[4]%\%}"
				[ $VOL -ge 100 ] && exit 0 || break
			fi
		fi
	done <<< "$(/usr/bin/pacmd list-sinks)"

	if [ -x /usr/bin/pactl ]; then
		/usr/bin/pactl play-sample x11-volume-change & disown
		/usr/bin/pactl set-sink-volume "$MASTER" +500
	fi

	if [ -x /usr/bin/pkill ]; then
		# Use 'signal=1' and 'interval=once' in the i3blocks configuration
		# file, in order to have this update only when needed.
		/usr/bin/pkill -RTMIN+1 i3blocks
	fi
fi

# vim: noexpandtab colorcolumn=84 tabstop=8 noswapfile nobackup
